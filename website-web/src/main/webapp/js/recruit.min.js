$(function(){$(".spanBtn").hover(function(){$(this).css({"border":"1px solid #b90b2c","background":"#b90b2c"});$(this).children("i").css({"color":"#fff"})},function(){$(this).css({"border":"1px solid #000","background":"#fff"});$(this).children("i").css({"color":"#000"})});$(document).on("click","#tabInforCon .row",function(){if($(this).hasClass("active")){$(this).removeClass("active");$(this).children("div.iconfont").removeClass("rotate");$(this).next().slideUp(500)}else{$(this).addClass("active").siblings().removeClass("active");$(this).children("div.iconfont").addClass("rotate").removeClass("rotate1");$(this).siblings().children("div.iconfont").addClass("rotate1").removeClass("rotate");$("#tabInforCon").find(".tabInforConRequire").slideUp(500);$(this).next().slideDown(500)}});var minH=$(".tabMenu").height();$(".menuBox").css({"minHeight":minH+20});var menuli=$(".tabMenu ul>li");menuli.on("click",function(){$(this).addClass("selectLi").siblings().removeClass("selectLi");$(this).children(".zhuangshi").removeClass("hide");$(this).siblings().children(".zhuangshi").addClass("hide");var positionType=$(this).attr("value");$("#positionType").val(positionType);var recruitType=$("#recruitType").val();getProvinceRecord(positionType,recruitType);getRecruitRecord(positionType,"",recruitType,"")});var zpObj=$(".typeAll a");zpObj.on("click",function(){$(this).addClass("active").parent(".typeAll").siblings().children("a").removeClass("active")});$(document).on("click",".requireConBtn button",function(){$("#city").hide();$("#tdgw").hide();$(".error").hide();$(".jltd-alt").hide();$(".jltd-altPeople").hide();$(".errorPic").hide();$(".errorWJ").hide();var height1=$(".recruit").height();var height2=$(".footer").height();var activeObj=$("#tabInforCon").children(".active");var city=activeObj.children("div").eq(2).text();var infor=activeObj.children("div").eq(0).text();var zpType=$("#recruitType").val();var zpTypeText="";if(zpType==1){zpTypeText="校园招聘"}else{if(zpType==2){zpTypeText="社会招聘"}}$("#jianlitoudi .jltd-top ul li").eq(0).children("span").text(zpTypeText);$("#jianlitoudi .jltd-top ul li").eq(1).children("span").text(city);$("#jianlitoudi .jltd-top ul li").eq(2).children("span").text(infor);$(".jianlitoudi").height(height1+height2);$(".jianlitoudi").show();$(document).scrollTop(0)});var close=$(".jltd-close");close.on("click",function(){$(".jianlitoudi").hide();init()});var jyjlBtn=$("#jyjlBtn");var jyjlNum=1;jyjlBtn.on("click",function(){var obj=$("body").children(".jyjlModal").clone(true);$(".jyjlCon").append(obj);$(".jyjlCon").find(".jyjlModal").show();$(".jyjlCon").find(".jyjlModal:last-child").find(".rowJyjlTime").attr("id","rowJyjlTime"+jyjlNum);laydate.render({elem:"#rowJyjlTime"+jyjlNum,range:true});jyjlNum++});var gzjlBtn=$("#gzjlBtn");var gzjlNum=1;gzjlBtn.on("click",function(){var obj=$("body").children(".gzjlModal").clone(true);$(".gzjlCon").append(obj);$(".gzjlCon").find(".gzjlModal").show();$(".gzjlCon").find(".gzjlModal:last-child").find(".rowGzjlTime").attr("id","rowGzjlTime"+gzjlNum);laydate.render({elem:"#rowGzjlTime"+gzjlNum,range:true});gzjlNum++});var xmNameBtn=$("#xmNameBtn");var xmNameNum=1;xmNameBtn.on("click",function(){var obj=$("body").children(".xmNameModal").clone(true);$(".xmNameCon").append(obj);$(".xmNameCon").find(".xmNameModal").show();$(".xmNameCon").find(".xmNameModal:last-child").find(".rowXmNameTime").attr("id","rowXmNameTime"+xmNameNum);laydate.render({elem:"#rowXmNameTime"+xmNameNum,range:true});xmNameNum++});var xnryBtn=$("#xnryBtn");var xnryNum=1;xnryBtn.on("click",function(){var obj=$("body").children(".xnryModal").clone(true);$(".xnryCon").append(obj);$(".xnryCon").find(".xnryModal").show();$(".xnryCon").find(".xnryModal:last-child").find(".rowXnryTime").attr("id","rowXnryTime"+xnryNum);laydate.render({elem:"#rowXnryTime"+xnryNum,range:true});xnryNum++});var xnzwBtn=$("#xnzwBtn");var xnzwNum=1;xnzwBtn.on("click",function(){var obj=$("body").children(".xnzwModal").clone(true);$(".xnzwCon").append(obj);$(".xnzwCon").find(".xnzwModal").show();$(".xnzwCon").find(".xnzwModal:last-child").find(".rowXnzwTime").attr("id","rowXnzwTime"+xnzwNum);laydate.render({elem:"#rowXnzwTime"+xnzwNum,range:true});xnzwNum++});$(document).on("click",".remove",function(){$(this).parent().parent().remove()});$(document).on("click","#jltdBtn",function(){var name=$("#nameCn").val();var phone=$("#phoneMobile").val();var str=/^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|166|198|199)\d{8}$/;var yzm=$("#rowYZM").val();var city=$("#city option:selected").attr("value");var tdgw=$("#tdgw option:selected").attr("value");var tdType=$(".jianlitoudi .jltd-top ul li").eq(0).children("span").text();if(name!=""&&str.test(phone)&&yzm!=""&&city!=""&&tdgw!=""){$(".jltd-alt").hide();$(".jltd-altPeople").hide();var activeObj=$("#tabInforCon").children(".active");var infor=activeObj.children("div").eq(0).text();var city=activeObj.children("div").eq(2).text();var recruitCity=activeObj.children("input").val();var hrResumeBasic=[];
var nameCn=$("#nameCn").val();var phoneMobile=$("#phoneMobile").val();var gender=$("#gender").val();var marriage=$("#marriage").val();var emailPerson=$("#emailPerson").val();var addressDetail=$("#addressDetail .prov").val()+$("#addressDetail .city").val()+$("#addressDetail .dist").val();var photoPath=$("#photoSavePath").val();var selfEvaluation=$("#selfEvaluation").val();var expectSalary=$("#expectSalary").val();var attachmentPath=$("#attachmentSavePath").val();var recruitType=$("#jltd-recruitType").val();var resumeStatus;if(recruitType=="typePeople"){resumeStatus="70";city=$("#city").find("option:selected").text();recruitCity=$("#city").find("option:selected").val();infor=$("#tdgw").find("option:selected").text()}hrResumeBasic.push({"companyId":recruitCity,"expectWorkplace":city,"applyPosition":infor,"nameCn":nameCn,"phoneMobile":phoneMobile,"gender":gender,"marriage":marriage,"emailPerson":emailPerson,"addressDetail":addressDetail,"photoPath":photoPath,"selfEvaluation":selfEvaluation,"expectSalary":expectSalary,"attachmentPath":attachmentPath,"resumeStatus":resumeStatus,"getType":"3","resumeChannelId":"14"});var hrResumeEducationList=JSON.stringify(getEducation());var hrResumeWorkList=JSON.stringify(getWork());var hrResumeProjectList=JSON.stringify(getProject());var hrResumeLanguageList=JSON.stringify(getLanguage());var hrResumeDutyList=JSON.stringify(getDuty());var hrResumeHonorList=JSON.stringify(getHonor());var webResumeBasic=JSON.stringify(hrResumeBasic);$("#webResumeBasic").val(webResumeBasic);$("#webResumeEducationList").val(hrResumeEducationList);$("#webResumeWorkList").val(hrResumeWorkList);$("#webResumeProjectList").val(hrResumeProjectList);$("#webResumeLanguageList").val(hrResumeLanguageList);$("#webResumeDutyList").val(hrResumeDutyList);$("#webResumeHonorList").val(hrResumeHonorList);$.post("postHrResumeAction.json",$("#form").serializeArray(),function(ret){var result=ret.serviceResult;if(result.success){$("body").css("overflow","hidden");$(".jltd-success").show()}else{}}).error(function(){})}else{if(tdType=="校园招聘"||tdType=="社会招聘"){$(".jltd-alt").show()}else{if(tdType=="储备人才库"){$(".jltd-altPeople").show()}}}});var _close=$(".success-close");_close.on("click",function(){$(".jltd-success").hide();$(".jianlitoudi").hide();$("body").css("overflow","auto");init()})});function init(){$("#form")[0].reset();$("#report").html("");$(".jyjlCon .jyjlModal").each(function(){if($(this).index()>0){$(this).remove()}});$(".gzjlCon .gzjlModal").each(function(){if($(this).index()>0){$(this).remove()}});$(".xmNameCon .xmNameModal").each(function(){if($(this).index()>0){$(this).remove()}});$(".xnryCon .xnryModal").each(function(){if($(this).index()>0){$(this).remove()}});$(".xnzwCon .xnzwModal").each(function(){if($(this).index()>0){$(this).remove()}})}myLaydate();function myLaydate(){laydate.render({elem:"#jianlitoudi .rowJyjlTime",range:true});laydate.render({elem:"#jianlitoudi .rowGzjlTime",range:true});laydate.render({elem:"#jianlitoudi .rowXmNameTime",range:true});laydate.render({elem:"#jianlitoudi .rowXnryTime",range:true});laydate.render({elem:"#jianlitoudi .rowXnzwTime",range:true})}var photoInput=document.querySelector("#photoPath");photoInput.onchange=function(){var fileObj=this.files[0];var fileName=fileObj.name;var type=(fileName.substr(fileName.lastIndexOf("."))).toLowerCase();if(type!=".jpg"&&type!=".jpeg"&&type!=".png"){$(".errorPic").show();return false}var formFile=new FormData();formFile.append("file",fileObj);var data=formFile;$.ajax({url:webRoot+"/system/recruit/uploadAction",data:data,type:"Post",dataType:"json",cache:false,processData:false,contentType:false,success:function(ret){$("#photoSavePath").val(ret.result.savePath);$(".errorPic").hide()},});lrz(this.files[0],{width:400},function(results){var type=results.origin.type.split("/")[0];var report=document.querySelector("#report");report.innerHTML="";if(type=="image"){demo_report("原始图片",results.blob,results.origin.size)}})};function demo_report(title,src,size){var img=new Image(),li=document.createElement("li"),size=(size/1024).toFixed(2)+"KB";img.onload=function(){var content="<ul>"+"<li>"+title+"("+img.width+" X "+img.height+")</li>"+'<li class="text-cyan">'+size+"</li>"+"</ul>";li.className="item";li.appendChild(img);document.querySelector("#report").appendChild(li)};img.src=src}function uploadPhoto(){return $("#photoPath").click()}function uploadFile(){return $("#attachmentPath").click()}var attachmentInput=document.querySelector("#attachmentPath");attachmentInput.onchange=function(){var fileObj=this.files[0];var fileName=fileObj.name;var formFile=new FormData();formFile.append("file",fileObj);var data=formFile;$.ajax({url:webRoot+"/system/recruit/uploadAction",data:data,type:"Post",dataType:"json",cache:false,processData:false,contentType:false,success:function(ret){$("#attachmentSavePath").val(ret.result.savePath);$("#attachmentFileName").val(ret.result.savePath);$(".errorWJ").show()},})};var verifyCode=new GVerify({id:"v_container",type:"number"});
var inputObj=$("#rowYZM");inputObj.on("keyup",function(){var val=$(this).val();if(val.length==4){var res=verifyCode.validate(val);if(res){$(".error").hide()}else{$(".error").show();$(this).val("")}}else{if(val.length>4){$(".error").show();$(this).val("")}}});inputObj.on("blur",function(){var val=$(this).val();if(val.length<4){$(".error").show();$(this).val("")}});$(function(){$(".panel-type3 a").on("click",function(){$(".error").hide();$(".jltd-alt").hide();$(".jltd-altPeople").hide();$(".errorPic").hide();$(".errorWJ").hide();var height1=$(".recruit").height();var height2=$(".footer").height();$(".jianlitoudi").height(height1+height2);$(".jianlitoudi .jltd-top ul li").eq(0).children("span").text("储备人才库");$(".jianlitoudi .jltd-top ul li").eq(1).children("span").text("");$(".jianlitoudi .jltd-top ul li").eq(2).children("span").text("");$(".jianlitoudi").show();$(document).scrollTop(0);$("#city").css("display","inline-block");$("#jltd-recruitType").val("typePeople");$("#tdgw").css("display","inline-block");getProvinceRecord2("2");getRecruitRecord2()});var _recruitType=$("#recruitType").val();if(_recruitType==1){$(".panel-type1").find("a.textCN").addClass("active");$(".panel-type2").find("a.textCN").removeClass("active")}else{if(_recruitType==2){$(".panel-type2").find("a.textCN").addClass("active");$(".panel-type1").find("a.textCN").removeClass("active")}}$(".schoolRecruit").click(function(){$("#recruitType").val("1");var positionType=$("#positionType").val();getProvinceRecord(positionType,"1");getRecruitRecord(positionType,"","1","")});$(".socialRecruit").click(function(){$("#recruitType").val("2");var positionType=$("#positionType").val();getProvinceRecord(positionType,"2");getRecruitRecord(positionType,"","2","")});$("#recruitCityName").change(function(){var recruitType=$("#recruitType").val();var recruitCityName=$("#recruitCityName").val();var positionType=$("#positionType").val();getRecruitRecord(positionType,recruitCityName,recruitType,"")});$("#recruitPosition").change(function(){var recruitType=$("#recruitType").val();var recruitCityName=$("#recruitCityName").val();var id=$("#recruitPosition").val();var positionType=$("#positionType").val();getRecruitRecord(positionType,recruitCityName,recruitType,id)})});function getRecruitRecord(positionType,recruitCityName,recruitType,id){$.post("getRecordAction.json",{"positionType":positionType,"recruitCityName":recruitCityName,"recruitType":recruitType,"id":id},function(ret){var result=ret.serviceResult;if(result.success){$("#tabInforCon").empty();var html="";var positionOption='<option value="">请选择职位</option>';var record=result.result;var arr=[];if(record.length>0){for(var i=0;i<record.length;i++){if(id==""){var addFlag=true;for(var j=0;j<arr.length;j++){if(arr[j].id==record[i].id){addFlag=false}}arr.push(record[i]);if(addFlag){positionOption+='<option value="'+record[i].id+'">'+record[i].recruitPosition+"</option>"}}html+='<div class="row"><div class="col-sm-3">'+record[i].recruitPosition+'</div><div class="col-sm-3 money">'+record[i].salary+"</div>"+'<div class="col-sm-4">'+record[i].recruitCityName+'</div><input hidden class="recruitCity" value="'+record[i].recruitCity+'"><div class="col-sm-2 iconfont icon-jiantou-down"></div></div>'+'<div class="tabInforConRequire"><div class="requireCon"><div class="requireConTop">'+record[i].positionIntroduce+"</div></div>"+'<div class="requireConBtn"><button type="button"><i class="iconfont icon-icon"></i>投递</button></div></div></div>'}}if(id==""){$("#recruitPosition").empty();$("#recruitPosition").append(positionOption)}$("#tabInforCon").append(html);$("#tabInforCon").show()}}).error(function(){})}function getRecruitRecord2(){$.post("getPositionList.json",{},function(ret){if(ret.success){var positionOption='<option value="">请选择职位</option>';var record=ret.result;if(record.length>0){for(var i=0;i<record.length;i++){positionOption+='<option value="'+record[i].id+'">'+record[i].positionName+"</option>"}}$("#tdgw").empty();$("#tdgw").append(positionOption)}}).error(function(){})}function getProvinceRecord(positionType,recruitType){$.post("getProvinceRecordAction.json",{"positionType":positionType,"recruitType":recruitType},function(ret){var result=ret.serviceResult;if(ret.serviceResult.success){$("#recruitCityName").empty();var html='<option value="">请选择城市</option>';var record=result.result;if(record.length>0){for(var i=0;i<record.length;i++){html+='<option value="'+record[i].recruitCityName+'">'+record[i].recruitCityName+"</option>"}}$("#recruitCityName").append(html)}}).error(function(){})}function getProvinceRecord2(recruitType){$.post("getDepartmentByDepartmentPCd.json",{},function(ret){if(ret.success){$("#city").empty();$("#tdgw").empty();var html='<option value="">请选择城市</option>';var html2='<option value="">请选择职位</option>';var record=ret.result;if(record.length>0){for(var i=0;i<record.length;i++){html+='<option value="'+record[i].id+'">'+record[i].areas+"</option>"}}$("#city").append(html);$("#tdgw").append(html2)}}).error(function(){})
}function getEducation(){var arr=[];$(".jltd-middle .jyjlModal").each(function(i){var date=$(this).find(".rowJyjlTime").val();var startDate="";var endDate="";if(date.length>10){startDate=date.substring(0,10);endDate=date.substring(date.length-10,date.length)}var school=$(this).find(".school").val();var major=$(this).find(".rowMajor").val();var degreeName=$(this).find(".degreeName").val();arr.push({"startDate":startDate,"endDate":endDate,"school":school,"major":major,"degreeName":degreeName,"delFlag":"0"})});return arr}function getWork(){var arr=[];$(".jltd-middle .gzjlModal").each(function(i){var date=$(this).find(".rowGzjlTime").val();var startDate="";var endDate="";if(date.length>10){startDate=date.substring(0,10);endDate=date.substring(date.length-10,date.length)}var company=$(this).find(".company").val();var job=$(this).find(".job").val();arr.push({"startDate":startDate,"endDate":endDate,"company":company,"job":job,"delFlag":"0"})});return arr}function getProject(){var arr=[];$(".jltd-middle .xmNameModal").each(function(i){var date=$(this).find(".rowXmNameTime").val();var startDate="";var endDate="";if(date.length>10){startDate=date.substring(0,10);endDate=date.substring(date.length-10,date.length)}var projectName=$(this).find(".projectName").val();var projectRemark=$(this).find(".projectRemark").val();arr.push({"startDate":startDate,"endDate":endDate,"projectName":projectName,"projectRemark":projectRemark,"delFlag":"0"})});return arr}function getHonor(){var arr=[];$(".jltd-middle .xnryModal").each(function(i){var date=$(this).find(".rowXnryTime").val();var startDate="";var endDate="";if(date.length>10){startDate=date.substring(0,10);endDate=date.substring(date.length-10,date.length)}var honorName=$(this).find(".honorName").val();arr.push({"startDate":startDate,"endDate":endDate,"honorName":honorName,"delFlag":"0"})});return arr}function getDuty(){var arr=[];$(".jltd-middle .xnzwModal").each(function(i){var date=$(this).find(".rowXnzwTime").val();var startDate="";var endDate="";if(date.length>10){startDate=date.substring(0,10);endDate=date.substring(date.length-10,date.length)}var dutyName=$(this).find(".dutyName").val();var dutyDescription=$(this).find(".dutyDescription").val();arr.push({"startDate":startDate,"endDate":endDate,"dutyName":dutyName,"dutyDescription":dutyDescription,"delFlag":"0"})});return arr}function getLanguage(){var arr=[];$(".jltd-middle .yydj").each(function(i){var languageName=$(this).find(".languageName").val();var hearAbli=$(this).find("#hearAbli").val();var readAbli=$(this).find("#readAbli").val();var languageEvaluate=readAbli+"|"+hearAbli;if(languageName!=""&&languageName!=null&&languageName!=undefined){arr.push({"languageName":languageName,"languageEvaluate":languageEvaluate,"delFlag":"0"})}});return arr};